<!--
Form to register employee
just copy the register form
and
-->

<mat-card class="w-full my-0 mx-auto flex flex-col p-10  border-base-300 border rounded-xl">
  <mat-card-content class="p-10 w-full min-h-[70dvh] flex flex-col gap-4 justify-evenly">
    <form class="flex flex-col gap-2 h-full justify-evenly" (ngSubmit)="submit()" [formGroup]="form">
      <div class="flex flex-row gap-1 w-full">
        <div class="w-full">
          <label class="label m-2">Nom</label>
          <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
            <input class="w-full focus:outline-0 h-full px-2" formControlName="name" placeholder="RAKOTO" />
          </div>
          @if (form.get('name')?.invalid && (form.get('name')?.dirty || form.get('name')?.touched)) {
          <span class="text-xs text-error">
            @if (form.get('name')?.hasError('required')) {
            Veuillez entrer le nom
            }</span>
          }
        </div>
        <div class="w-full">
          <label class="label m-2">Prénoms</label>
          <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
            <input class="w-full focus:outline-0 h-full px-2" formControlName="firstname" placeholder="Jean" />
          </div>
          @if (form.get('firstname')?.invalid && (form.get('firstname')?.dirty || form.get('firstname')?.touched))
          {
          <span class="text-xs text-error">
            @if (form.get('firstname')?.hasError('required')){ Veuillez entrer le prénoms}</span>
          }
        </div>
      </div>

      <div class="flex flex-row gap-1 w-full">
        <div class="w-full">
          <label class="label m-2">Date de Naissance</label>
          <div class="w-full items-center flex flex-row rounded-xl border
                  border-slate-300 h-10 px-2 focus-within:outline focus-within:outline-primary">
            <input class="focus:outline-0 w-full h-full" [max]="maxDate" [matDatepicker]="picker"
              formControlName="birth_date">
            <mat-datepicker class="border border-r-red-300 bg-white drop-shadow-md hidden" color="primary"
              #picker></mat-datepicker>
            <button class="aspect-square" type="button" (click)="picker.open()"><i-tabler
                class="aspect-squarew-5 iconify" name="calendar" /></button>
          </div>
          @if (form.get('birth_date')?.invalid && (form.get('birth_date')?.dirty ||
          form.get('birth_date')?.touched))
          {
          <span class="text-xs text-error">
            @if (form.get('birth_date')?.hasError('required')){ Veuillez entrer la
            date de naissance}</span>
          }

        </div>

        <div class="w-full">
          <label class="label m-2">Sexe</label>
          <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
            <select class="w-full focus:outline-0 px-2 h-full" matNativeControl formControlName="gender">
              <option value="masculin">Homme</option>
              <option value="feminin">Femme</option>
            </select>
          </div>
        </div>

      </div>

      <div class="w-full">
        <label class="label m-2">Role</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
          <select class=" w-full focus:outline-0 px-2 h-full" matNativeControl formControlName="role_id">
            <option value="role_003">Mécanicien</option>
            <option value="role_001">Manager</option>
          </select>
        </div>
      </div>



      <div class="w-full">
        <label class="label m-2">CIN</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
          <input class="w-full focus:outline-0  px-2 h-full" formControlName="CIN" placeholder="101...010"
            pattern="[0-9]*" />
        </div>
        @if (form.get('CIN')?.invalid && (form.get('CIN')?.dirty || form.get('CIN')?.touched)) {
        <span class="text-xs text-error">
          @if (form.get('CIN')?.hasError('required')) {Veuillez entrer le CIN}
          @if (form.get('CIN')?.hasError('maxLength')) {CIN trop long}
          @if (form.get('CIN')?.hasError('minLength')) {CIN trop court}
          @if (form.get('CIN')?.hasError('incorrect')) {Ce numero CIN est déja pris}
        </span>
        }
      </div>

      <div>
        <label class="label m-2">Mail</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
          <input class="w-full focus:outline-0 h-full px-2" formControlName="mail" email />
        </div>
        @if (form.get('mail')?.invalid && (form.get('mail')?.dirty || form.get('mail')?.touched)) {

        <span class="text-xs text-error">
          @if (form.get('mail')?.hasError('required')) {Veuillez entrer le email}
          @if (form.get('mail')?.hasError('email')) {Veuillez entrer un email valide }
          @if (form.get('mail')?.hasError('incorrect')) {Cet email est déja pris}
        </span>
        }
      </div>

      <div class="w-full">
        <label class="label m-2">Téléphone</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline focus-within:outline-primary">
          <input class="w-full focus:outline-0 h-full px-2" formControlName="phone" />
        </div>
        @if (form.get('phone')?.invalid && (form.get('phone')?.dirty || form.get('phone')?.touched)) {

        <span class="text-xs text-error">
          @if (form.get('phone')?.hasError('required')){Veuillez entrer le numero de téléphone}
          @if (form.get('phone')?.hasError('incorrect')) {Cet numero de téléphone email est déja pris}
        </span>
        }
      </div>

      <div>
        <label class="label m-2">Mot de passe</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline
                focus-within:outline-primary">
          <input class="w-full focus:outline-0 h-full px-2" type="password" formControlName="password" />
        </div>
        @if (form.get('password')?.invalid && (form.get('password')?.dirty || form.get('password')?.touched)) {

        <span class="text-xs text-error">@if (form.get('password')?.hasError('required'))
          {Veuillez entrer le mot de passe}
        </span>
        }
      </div>

      <div>
        <label class="label m-2">Confirmer mot de passe</label>
        <div class="rounded-xl w-full border border-slate-300 h-10 focus-within:outline
                focus-within:outline-primary">
          <input class="w-full focus:outline-0 h-full px-2" type="password" formControlName="password_confirm" />
        </div>
        @if (form.get('password_confirm')?.invalid && (form.get('password_confirm')?.dirty ||
        form.get('password_confirm')?.touched)) {
        <span class="text-xs text-error">
          @if (form.get('password_confirm')?.hasError('required')) {Veuillez confirmer le mot de passe}
          @if (form.get('password_confirm')?.hasError('notSame')) {Le mot de passe est différent}
        </span>
        }
      </div>
      <hr class="bg-stone-300 w-full h-[1px]" />
      <!-- <button type="button" (click)="test()" class="btn btn-primary">
       Test
      </button> -->
      <button type="submit" [disabled]="form.invalid" class="btn btn-primary">
        Ajouter
      </button>
    </form>
  </mat-card-content>
  <!--         <button type="button" (click)="test()">Test</button> -->
</mat-card>
